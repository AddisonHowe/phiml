import os
import numpy as np

OUTDIR = "tests/simtest1/data_train"
# OUTDIR = "tests/simtest1/data_valid"

# Dataset 1
d1 = {
    'ts' : [0., 2e-3,],
    'xs' : [[[0,0],[0,1],[1,0],[1,1]],
            [[0,0],[0,1],[1,0],[1,1]],],
    'p_params' : [10,0,1,10,10],
    'ps' : [[0,1],[0,1]],
    'dt' : 1e-3,
    'sigma' : 0.0,
    'x1hat_1' : [
        [-0.01, -0.015],
        [-0.0004414033827482706, 0.9998399695099601],
        [0.9948805500171995, -0.0037163469762707077],
        [0.9960040933541041, 0.9989883818843098],
    ],
    'x1hat_2' : [
        [-0.01991849661234501, -0.02992974822829585],
        [-0.0008788266846985779, 0.9996806257642014],
        [0.9897336432566732, -0.0074945257964596],
        [0.9920083815230861, 0.9979766080278729],
    ],
}

# Dataset 2
d2 = {
    'ts' : [2e-3, 4e-3,],
    'xs' : [[[1,1],[1,0],[0,1],[0,0]],
            [[1,1],[1,0],[0,1],[0,0]],],
    'p_params' : [10,0,1,10,10],
    'ps' : [[0,1],[0,1]],
    'dt' : 1e-3,
    'sigma' : 0.0,
    'x1hat_1' : [
        [0.9960040933541041, 0.9989883818843098],
        [0.9948805500171995, -0.0037163469762707077],
        [-0.0004414033827482706, 0.9998399695099601],
        [-0.01, -0.015],
    ],
    'x1hat_2' : [
        [0.9920083815230861, 0.9979766080278729],
        [0.9897336432566732, -0.0074945257964596],
        [-0.0008788266846985779, 0.9996806257642014],
        [-0.01991849661234501, -0.02992974822829585],
    ],
}

# Dataset 2.1
d3 = {
    'ts' : [5e-3, 7e-3,],
    'xs' : [[[2,0],[2,1],[3,0],[3,1]],
            [[2,0],[2,1],[3,0],[3,1]],],
    'p_params' : [0,10,10,1,0],
    'ps' : [[1,0],[1,0]],
    'dt' : 1e-3,
    'sigma' : 0.0,
    'x1hat_1' : [
        [1.9978547526463966, 0.0005816725728615618],
        [1.9979995216883597, 1.0009987948713117],
        [2.9979807924756896, 0.0009427097395239787],
        [2.9979999496183507, 1.0009998547199968],
    ],
    'x1hat_2' : [
        [1.9957093465218303, 0.001162973755347985],
        [1.9959990437968442, 1.0019975912940273],
        [2.9959616148753936, 0.0018855106739063623],
        [2.9959998993200947, 1.001999709712119],
    ],
}

# Dataset 2.2
d4 = {
    'ts' : [7e-3, 9e-3],
    'xs' : [[[3,0],[3,1],[2,0],[2,1]],
            [[2,0],[2,1],[3,0],[3,1]],],
    'p_params' : [0,10,10,1,0],
    'ps' : [[1,0],[1,0]],
    'dt' : 1e-3,
    'sigma' : 0.0,
    'x1hat_1' : [
        [2.9979807924756896, 0.0009427097395239787],
        [2.9979999496183507, 1.0009998547199968],
        [1.9978547526463966, 0.0005816725728615618],
        [1.9979995216883597, 1.0009987948713117],
    ],
    'x1hat_2' : [
        [2.9959616148753936, 0.0018855106739063623],
        [2.9959998993200947, 1.001999709712119],
        [1.9957093465218303, 0.001162973755347985],
        [1.9959990437968442, 1.0019975912940273],
    ],
}

DATA = [d1, d2, d3, d4]

for simidx, d in enumerate(DATA):
    simdir = f"{OUTDIR}/sim{simidx}"
    os.makedirs(simdir, exist_ok=True)
    # parse the dictionary
    ts = d['ts']
    xs = d['xs']
    p_params = d['p_params']
    ps = d['ps']
    # construct arrays
    ts = np.array(ts)
    xs = np.array(xs)
    p_params = np.array(p_params)
    ps = np.array(ps)
    np.save(f"{simdir}/ts.npy", ts)
    np.save(f"{simdir}/xs.npy", xs)
    np.save(f"{simdir}/ps.npy", ps)
    np.save(f"{simdir}/p_params.npy", p_params)
